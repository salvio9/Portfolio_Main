use atp

ALTER TABLE Players ADD COLUMN id INT AUTO_INCREMENT UNIQUE FIRST;
ALTER TABLE Tournaments ADD COLUMN id INT AUTO_INCREMENT UNIQUE FIRST;
Alter table Games add column tournament_id int;
Alter table games add column player_id int;

ALTER TABLE `players` ADD INDEX(`Link`);
ALTER TABLE `games` ADD INDEX(`Player`);

update games inner join players on games.player = players.link set games.player_id = players.id;

ALTER TABLE `games` ADD INDEX(`Date`, `Tournament`);
ALTER TABLE `games` ADD INDEX(`Tournament`);
ALTER TABLE `games` ADD INDEX(`Date`);
ALTER TABLE `tournaments` ADD INDEX(`Date`, `Name`);
ALTER TABLE `tournaments` ADD INDEX(`Date`);
ALTER TABLE `tournaments` ADD INDEX(`Name`);

update games inner join tournaments on (games.date = tournaments.date and games.tournament = tournaments.name) set games.tournament_id = tournaments.id;

alter table players add column mainhand varchar(100);
alter table players add column backhand varchar(100);

update players set mainhand = substring_index(hand,",",1);
update players set backhand = substring_index(hand,",",-1);

alter table players add column country varchar(100);

Create table Paises(Pais varchar(100),Codigo varchar(100));

LOAD DATA  LOCAL INFILE "C:\\data\\atp\\countries_net.csv"
INTO TABLE paises
COLUMNS TERMINATED BY ','
OPTIONALLY ENCLOSED BY '"'
ESCAPED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 LINES;


create view missing_players as select distinct opponent op from games where opponent not in (select name from players) ;
insert into players(Name) select op from missing_players;

alter table games change column player_id player1_id int(11);
alter table games add column player2_id int(11);

delete from players where name = 'bye';

ALTER TABLE `games` ADD INDEX(`Opponent`);
ALTER TABLE `players` ADD INDEX(`Name`);


update games inner join players on games.opponent = players.name set games.player2_id = players.id where games.opponent <> 'bye';

ALTER TABLE `games` ADD INDEX(`player2_id`);
ALTER TABLE `games` ADD INDEX(`player1_id`);

alter table games add column winner_id int(11);
alter table games add column loser_id int(11);

ALTER TABLE `games` ADD INDEX(`WL`);

update games set winner_id = player1_id where WL = 'W'; 
update games set loser_id = player2_id where WL = 'W';

update games set winner_id = player2_id where WL = 'L'; 
update games set loser_id = player1_id where WL = 'L'; 

delete from games where opponent = 'bye';

alter ignore table games add unique (gameround,tournament_id,loser_id,winner_id);





alter table tournaments add column country varchar(100);

update tournaments inner join paises on tournaments.location like concat('%',paises.pais) set tournaments.country = paises.codigo;


select distinct location from tournaments where country is null;

update tournaments set country = 'US' where (location like '% U.S.A.' or location like '% USA' or location like '% US' or location like '%U.S.A.' or location like '%United S%' or location like '%Texas%');
update tournaments set country = 'GB' where  (location like '% Great Britain' or location like '% Britain' or location like '% England' or location like '%UK' or location like '%Wales' or location like '%Scotland' or location like '%London%' or location like '%GBR');
update tournaments set country = 'RU' where location like '% Russia' or location like '%Russia' or location like '%Moscow%'; 
update tournaments set country = 'KR' where location like '%South Korea%' or location like '%Korea%';
update tournaments set country = 'CN' where location like '%Taipei%';
update tournaments set country = 'IR' where location like '%Iran';
update tournaments set country = 'BA' where location like '%Bosnia%';
update tournaments set country = 'SK' where location like '%Slovak%' or location like '%Slovkia%';
update tournaments set country = 'VN' where location like '%Vietnam%';
update tournaments set country = 'VE' where location like '%Venezuela%' or location like '%Venezeuela%';
update tournaments set country = 'BO' where location like '%Bolivia%';
update tournaments set country = 'CZ' where location like '%Czech%' or location like '%CZE';
update tournaments set country = 'CI' where location like '%Ivory Coast%';
update tournaments set country = 'AR' where location like '% ARG' or location like '%Argent' or location like '%Arg.' or location like '%Buenos Aires%';
update tournaments set country = 'BR' where location like '% BRA' or location like '%Rio de Janeiro%' or location like '%Brazi%' or location like '%Braz';
update tournaments set country = 'IL' where location like '% Isra' or location like '% ISR';
update tournaments set country = 'RS' where location like '%Belgrade%';
update tournaments set country = 'ZA' where location like '%South  Africa';
update tournaments set country = 'BE' where location like '%Liege%';
update tournaments set country = 'HK' where location like '%HKG%';
update tournaments set country = 'PH' where location like '%PHI' or location like '%Manila';
update tournaments set country = 'NL' where location like '%NED' or location like '%Amsterdam%';
update tournaments set country = 'MD' where location like '%Moldovia' or location like '%Moldova';
update tournaments set country = 'HR' where location like '%Crotia%';
update tournaments set country = 'SI' where location like '%Solvenia';
update tournaments set country = 'UY' where location like '%Uraguay' or location like '%Urugay';
update tournaments set country = 'CW' where location like '%Curacao%';
update tournaments set country = 'MX' where location like '%Meixco';
update tournaments set country = 'MY' where location like '%Kuala Lampur%' or location like '%Kuala Lumpur%';
update tournaments set country = 'MK' where location like '%Macedona';
update tournaments set country = 'IN' where location like '%Kolkata%';
update tournaments set country = 'BN' where location like '%Brunei%';
update tournaments set country = 'EG' where location like '%Egpyt';
update tournaments set country = 'ZA' where location like '%Doornfontein%';
update tournaments set country = 'CI' where location like '%Abidjan%';
update tournaments set country = 'ZA' where location like '%Polokwane%';
update tournaments set country = 'LU' where location like '%Esch-sur-Alzette%';
update tournaments set country = 'CN' where location like '%Nanjing%';
update tournaments set country = 'ID' where location like '%Jakarta%';
update tournaments set country = 'NL' where location like '%The Hague%';
update tournaments set country = 'CH' where location like '%Neuchatel';
update tournaments set country = 'FR' where location = 'Pau';
update tournaments set country = 'NL' where location like '%s-Hertogenbosch%';
update tournaments set country = 'CA' where location like '%Alberta';
update tournaments set country = 'SK' where location like '%Presov';
update tournaments set country = 'ES' where location like '%Palma de Mallorca%';
update tournaments set country = 'ZW' where location like '%Harare';
update tournaments set country = 'FR' where location like '%Uriage';
update tournaments set country = 'AT' where location like '%St Anton-Tirol%';
update tournaments set country = 'CA' where location like '% Canda';
update tournaments set country = 'SI' where location = 'Portoroz';
update tournaments set country = 'RU' where location = 'Korolev';
update tournaments set country = 'DO' where location = 'Santo Domingo, D.R.';
update tournaments set country = 'EG' where location like '%Sharm El Sheikh%';
update tournaments set country = 'FR' where location = 'Toulouse';
update tournaments set country = 'PL' where location like '%Belchatow%';
update tournaments set country = 'NC' where location = 'Noumea, New Caledoni';
update tournaments set country = 'IL' where location like '% Hasharon';
update tournaments set country = 'LU' where location like '%Mondorf-Les-Bains%';
update tournaments set country = 'TH' where location = 'Bangkok';
update tournaments set country = 'RO' where location like '%Bucharest%';
update tournaments set country = 'RS' where location like '%Nova Sad%';
update tournaments set country = 'PH' where location like '%Manilla%';
update tournaments set country = 'PK' where location = 'Lahore';
update tournaments set country = 'IQ' where location = 'Tehran';
update tournaments set country = 'TT' where location like '%Port-of-Spain%';
update tournaments set country = 'FR' where location like '%Forbach';
update tournaments set country = 'MA' where location like '%Casablanca%';
update tournaments set country = 'TH' where location like '%Nonthaburi%';
update tournaments set country = 'TN' where location like '% Monastir';
update tournaments set country = 'HR' where location like 'Umag,%';
update tournaments set country = 'CO' where location like '%, Columbia%';
update tournaments set country = 'ME' where location like 'Budva,%';
update tournaments set country = 'GT' where location like '%Guatemala%';
update tournaments set country = 'DE' where location like 'Wetzlar,%';
update tournaments set country = 'CU' where location = 'Havana';
update tournaments set country = 'BR' where location = 'Guarulhos';
update tournaments set country = 'RS' where location = 'Novi Sad, Yugoslavia';
update tournaments set country = 'CW' where location like 'Emmastad%';
update tournaments set country = 'ZA' where location like 'Nelspruit%';
update tournaments set country = 'SI' where location like '%Ljubljana%';
update tournaments set country = 'RO' where location like 'Constanta%';
update tournaments set country = 'ES' where location like 'Valldoreix%';
update tournaments set country = 'ID' where location like 'Surabaya%';
update tournaments set country = 'CO' where location like 'Villavicencio%';
update tournaments set country = 'BY' where location like 'Minsk%';
update tournaments set country = 'PL' where location like '%Wrocklaw' or location like 'Wroclaw%';
update tournaments set country = 'UA' where location like 'Novaya Kakhovka%';
update tournaments set country = 'US' where location like 'Salinas%';
update tournaments set country = 'AT' where location like 'Portschach%';
update tournaments set country = 'CU' where location like '%Habana%';
update tournaments set country = 'ZA' where location like '%Johannesburg%';
update tournaments set country = 'TW' where location like '%Kaohsiung%';
update tournaments set country = 'NZ' where location like '%Invercargill%';
update tournaments set country = 'AE' where location like '%U.A.E.%';
update tournaments set country = 'DE' where location like '%Braunschweig%';
update tournaments set country = 'SK' where location like '%Bratislava%';
update tournaments set country = 'US' where location like '%Oklahoma City%';
update tournaments set country = 'NZ' where location like '% NZ' or location like '%,NZ';
update tournaments set country = 'LA' where location = 'Laos' or location like '$,Laos' or location like '$ Laos';
update tournaments set country = 'ES' where location like '%Melilla%';
update tournaments set country = 'EG' where location like 'Cairo%';
update tournaments set country = 'UY' where location = 'Montevideo';
update tournaments set country = 'IT' where location like '%Sardinia';
update tournaments set country = 'PT' where location = 'Faro';
update tournaments set country = 'CN' where location like '%Wuhan%';
update tournaments set country = 'CL' where location like '%Chile%';
update tournaments set country = 'AU' where location like '%West Perth%';
update tournaments set country = 'BW' where location like '%Botwana%';
update tournaments set country = 'GB' where location = 'England';
update tournaments set country = 'DO' where location like '%Santo Domingo%';
update tournaments set country = 'BR' where location like 'Bahia%';
update tournaments set country = 'ZA' where location like 'Cape Town%';
update tournaments set country = 'MK' where location like '%Macedonia%';
update tournaments set country = 'FR' where location like '%Bourg-en-Bresse%'; 
update tournaments set country = 'FI' where location like '%Fiji Island%';
update tournaments set country = 'PH' where location like '%Phillipines%';
update tournaments set country = 'CW' where location like '%Willemstad%';
update tournaments set country = 'TW' where location like '%Tai-Chung, TPE%';
update tournaments set country = 'BO' where location like '%Santa Cruz de la Sie%';
update tournaments set country = 'SV' where location like '%El Salvador%';
update tournaments set country = 'HU' where location like '%Hodmezovasarhely%';
update tournaments set country = 'TW' where location like '%Tao Yuan%';
update tournaments set country = 'US' where location like '%Delray Beach%';
update tournaments set country = 'UY' where location like '%Montevideo%';
update tournaments set country = 'KZ' where location like '%Tashkent%';
update tournaments set country = 'US' where location like '%Fayetteville%';
update tournaments set country = 'TR' where location like '%Antalya%';
update tournaments set country = 'AU' where location like '%Sale, Victoria%';
update tournaments set country = 'CO' where location like '%Santa de Bogota, Col%';
update tournaments set country = 'AU' where location like '%Tasmania%';
update tournaments set country = 'NL' where location like '%Elndhoven%';
update tournaments set country = 'CA' where location like '%Mississauga%';
update tournaments set country = 'ZA' where location like '%Pretoria%';
update tournaments set country = 'IE' where location = 'Dublin';
update tournaments set country = 'CA' where location like '%Calgary%';
update tournaments set country = 'DN' where location like '%Rungsted Kyst%';
update tournaments set country = 'NZ' where location like '%Wellington';
update tournaments set country = 'DO' where location like '%Domincan Republic%';
update tournaments set country = 'TN' where location = 'Tunis';
update tournaments set country = 'HU' where location like '%Hunary%';
update tournaments set country = 'FR' where location like '%Martinique, Lesser Antilles%';
update tournaments set country = 'ES' where location like '%Barcelona%';
update tournaments set country = 'SY' where location like '%Syria%';
update tournaments set country = 'FR' where location like '%Reunion Island%';
update tournaments set country = 'PT' where location = 'Estoril';
update tournaments set country = 'EC' where location like '%Guayaquil%';
update tournaments set country = 'BR' where location like '%Florianapolis%' or location like '%Brasilia%';
update tournaments set country = 'IT' where location like '%Torre Del Greco, Ita%';
update tournaments set country = 'MX' where location like '%Toluca%';
update tournaments set country = 'LU' where location like '%Esch/Alzette%';
update tournaments set country = 'NZ' where location like '%Auckland, New Zealan%';
update tournaments set country = 'MX' where location like '%Mexica%' or location like '%Mexico City%';
update tournaments set country = 'ES' where location like '%Bakio, Bakio%';
update tournaments set country = 'AU' where location like '%Devonport%' or location = 'Devon';
update tournaments set country = 'QA' where location like 'Doha%';
update tournaments set country = 'IT' where location = 'Reggio Calabria';
update tournaments set country = 'HR' where location = 'Zagreb, Yugoslavia';
update tournaments set country = 'SW' where location = 'St.Gallen, Switz.';
update tournaments set country = 'US' where location like '%U.S.A';
update tournaments set country = 'DK' where country like '%DN%';
update tournaments set country = 'SZ' where country like '%SW%';
update tournaments inner join paises on paises.codigo like '%GB%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBC'; 
update tournaments inner join paises on paises.codigo like '%US%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBA' and tournaments.name like '%U.S.A.%' ;
update tournaments inner join paises on paises.codigo like '%IT%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBA' and tournaments.name like '%Italy%' ;
update tournaments inner join paises on paises.codigo like '%FR%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBA' and tournaments.name like '%France%' ;
update tournaments inner join paises on paises.codigo like '%EG%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBA' and tournaments.name like '%Egypt%' ;
update tournaments inner join paises on paises.codigo like '%IN%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBA' and tournaments.name like '%India%' ;
update tournaments inner join paises on paises.codigo like '%GB%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBA' and tournaments.name like '%Great Britain%' ;
update tournaments inner join paises on paises.codigo like '%ZW%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBA' and tournaments.name like '%Zimbabwe%' ;
update tournaments inner join paises on paises.codigo like '%BW%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBA' and tournaments.name like '%Botswana%' ;
update tournaments inner join paises on paises.codigo like '%VE%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'Lara' ;
update tournaments inner join paises on paises.codigo like '%US%' set tournaments.country = paises.codigo where tournaments.country is null and location = 'TBD' ;
update tournaments inner join paises on paises.codigo like concat(tournaments.country,'%') set tournaments.country = paises.codigo;







update players inner join paises on players.born like concat('%',paises.pais) set players.country = paises.codigo;
update players set country = 'US' where (born like '% U.S.A.' or born like '% USA' or born like '% US' or born like '%U.S.A.' or born like '%United S%' or born like '%Texas%');
update players set country = 'GB' where  (born like '% Great Britain' or born like '% Britain' or born like '% England' or born like '%UK' or born like '%Wales' or born like '%Scotland' or born like '%London%' or born like '%GBR');
update players set country = 'RU' where born like '% Russia' or born like '%Russia' or born like '%Moscow%'; 
update players set country = 'KR' where born like '%South Korea%' or born like '%Korea%';
update players set country = 'CN' where born like '%Taipei%';
update players set country = 'IR' where born like '%Iran';
update players set country = 'BA' where born like '%Bosnia%';
update players set country = 'SK' where born like '%Slovak%' or born like '%Slovkia%';
update players set country = 'VN' where born like '%Vietnam%';
update players set country = 'VE' where born like '%Venezuela%' or born like '%Venezeuela%';
update players set country = 'BO' where born like '%Bolivia%';
update players set country = 'CZ' where born like '%Czech%' or born like '%CZE';
update players set country = 'CI' where born like '%Ivory Coast%';
update players set country = 'AR' where born like '% ARG' or born like '%Argent' or born like '%Arg.' or born like '%Buenos Aires%';
update players set country = 'BR' where born like '% BRA' or born like '%Rio de Janeiro%' or born like '%Brazi%' or born like '%Braz';
update players set country = 'IL' where born like '% Isra' or born like '% ISR';
update players set country = 'RS' where born like '%Belgrade%';
update players set country = 'ZA' where born like '%South  Africa';
update players set country = 'BE' where born like '%Liege%';
update players set country = 'HK' where born like '%HKG%';
update players set country = 'PH' where born like '%PHI' or born like '%Manila';
update players set country = 'NL' where born like '%NED' or born like '%Amsterdam%';
update players set country = 'MD' where born like '%Moldovia' or born like '%Moldova';
update players set country = 'HR' where born like '%Crotia%';
update players set country = 'SI' where born like '%Solvenia';
update players set country = 'UY' where born like '%Uraguay' or born like '%Urugay';
update players set country = 'CW' where born like '%Curacao%';
update players set country = 'MX' where born like '%Meixco';
update players set country = 'MY' where born like '%Kuala Lampur%' or born like '%Kuala Lumpur%';
update players set country = 'MK' where born like '%Macedona';
update players set country = 'IN' where born like '%Kolkata%';
update players set country = 'BN' where born like '%Brunei%';
update players set country = 'EG' where born like '%Egpyt';
update players set country = 'ZA' where born like '%Doornfontein%';
update players set country = 'CI' where born like '%Abidjan%';
update players set country = 'ZA' where born like '%Polokwane%';
update players set country = 'LU' where born like '%Esch-sur-Alzette%';
update players set country = 'CN' where born like '%Nanjing%';
update players set country = 'ID' where born like '%Jakarta%';
update players set country = 'NL' where born like '%The Hague%';
update players set country = 'CH' where born like '%Neuchatel';
update players set country = 'FR' where born = 'Pau';
update players set country = 'NL' where born like '%s-Hertogenbosch%';
update players set country = 'CA' where born like '%Alberta';
update players set country = 'SK' where born like '%Presov';
update players set country = 'ES' where born like '%Palma de Mallorca%';
update players set country = 'ZW' where born like '%Harare';
update players set country = 'FR' where born like '%Uriage';
update players set country = 'AT' where born like '%St Anton-Tirol%';
update players set country = 'CA' where born like '% Canda';
update players set country = 'SI' where born = 'Portoroz';
update players set country = 'RU' where born = 'Korolev';
update players set country = 'DO' where born = 'Santo Domingo, D.R.';
update players set country = 'EG' where born like '%Sharm El Sheikh%';
update players set country = 'FR' where born = 'Toulouse';
update players set country = 'PL' where born like '%Belchatow%';
update players set country = 'NC' where born = 'Noumea, New Caledoni';
update players set country = 'IL' where born like '% Hasharon';
update players set country = 'LU' where born like '%Mondorf-Les-Bains%';
update players set country = 'TH' where born = 'Bangkok';
update players set country = 'RO' where born like '%Bucharest%';
update players set country = 'RS' where born like '%Nova Sad%';
update players set country = 'PH' where born like '%Manilla%';
update players set country = 'PK' where born = 'Lahore';
update players set country = 'IQ' where born = 'Tehran';
update players set country = 'TT' where born like '%Port-of-Spain%';
update players set country = 'FR' where born like '%Forbach';
update players set country = 'MA' where born like '%Casablanca%';
update players set country = 'TH' where born like '%Nonthaburi%';
update players set country = 'TN' where born like '% Monastir';
update players set country = 'HR' where born like 'Umag,%';
update players set country = 'CO' where born like '%, Columbia%';
update players set country = 'ME' where born like 'Budva,%';
update players set country = 'GT' where born like '%Guatemala%';
update players set country = 'DE' where born like 'Wetzlar,%';
update players set country = 'CU' where born = 'Havana';
update players set country = 'BR' where born = 'Guarulhos';
update players set country = 'RS' where born = 'Novi Sad, Yugoslavia';
update players set country = 'CW' where born like 'Emmastad%';
update players set country = 'ZA' where born like 'Nelspruit%';
update players set country = 'SI' where born like '%Ljubljana%';
update players set country = 'RO' where born like 'Constanta%';
update players set country = 'ES' where born like 'Valldoreix%';
update players set country = 'ID' where born like 'Surabaya%';
update players set country = 'CO' where born like 'Villavicencio%';
update players set country = 'BY' where born like 'Minsk%';
update players set country = 'PL' where born like '%Wrocklaw' or born like 'Wroclaw%';
update players set country = 'UA' where born like 'Novaya Kakhovka%';
update players set country = 'US' where born like 'Salinas%';
update players set country = 'AT' where born like 'Portschach%';
update players set country = 'CU' where born like '%Habana%';
update players set country = 'ZA' where born like '%Johannesburg%';
update players set country = 'TW' where born like '%Kaohsiung%';
update players set country = 'NZ' where born like '%Invercargill%';
update players set country = 'AE' where born like '%U.A.E.%';
update players set country = 'DE' where born like '%Braunschweig%';
update players set country = 'SK' where born like '%Bratislava%';
update players set country = 'US' where born like '%Oklahoma City%';
update players set country = 'NZ' where born like '% NZ' or born like '%,NZ';
update players set country = 'LA' where born = 'Laos' or born like '$,Laos' or born like '$ Laos';
update players set country = 'ES' where born like '%Melilla%';
update players set country = 'EG' where born like 'Cairo%';
update players set country = 'UY' where born = 'Montevideo';
update players set country = 'IT' where born like '%Sardinia';
update players set country = 'PT' where born = 'Faro';
update players set country = 'CN' where born like '%Wuhan%';
update players set country = 'CL' where born like '%Chile%';
update players set country = 'AU' where born like '%West Perth%';
update players set country = 'BW' where born like '%Botwana%';
update players set country = 'GB' where born = 'England';
update players set country = 'DO' where born like '%Santo Domingo%';
update players set country = 'BR' where born like 'Bahia%';
update players set country = 'ZA' where born like 'Cape Town%';
update players set country = 'MK' where born like '%Macedonia%';
update players set country = 'FR' where born like '%Bourg-en-Bresse%'; 
update players set country = 'FI' where born like '%Fiji Island%';
update players set country = 'PH' where born like '%Phillipines%';
update players set country = 'CW' where born like '%Willemstad%';
update players set country = 'TW' where born like '%Tai-Chung, TPE%';
update players set country = 'BO' where born like '%Santa Cruz de la Sie%';
update players set country = 'SV' where born like '%El Salvador%';
update players set country = 'HU' where born like '%Hodmezovasarhely%';
update players set country = 'TW' where born like '%Tao Yuan%';
update players set country = 'US' where born like '%Delray Beach%';
update players set country = 'UY' where born like '%Montevideo%';
update players set country = 'KZ' where born like '%Tashkent%';
update players set country = 'US' where born like '%Fayetteville%';
update players set country = 'TR' where born like '%Antalya%';
update players set country = 'AU' where born like '%Sale, Victoria%';
update players set country = 'CO' where born like '%Santa de Bogota, Col%';
update players set country = 'AU' where born like '%Tasmania%';
update players set country = 'NL' where born like '%Elndhoven%';
update players set country = 'CA' where born like '%Mississauga%';
update players set country = 'ZA' where born like '%Pretoria%';
update players set country = 'IE' where born = 'Dublin';
update players set country = 'CA' where born like '%Calgary%';
update players set country = 'DN' where born like '%Rungsted Kyst%';
update players set country = 'NZ' where born like '%Wellington';
update players set country = 'DO' where born like '%Domincan Republic%';
update players set country = 'TN' where born = 'Tunis';
update players set country = 'HU' where born like '%Hunary%';
update players set country = 'FR' where born like '%Martinique, Lesser Antilles%';
update players set country = 'ES' where born like '%Barcelona%';
update players set country = 'SY' where born like '%Syria%';
update players set country = 'FR' where born like '%Reunion Island%';
update players set country = 'PT' where born = 'Estoril';
update players set country = 'EC' where born like '%Guayaquil%';
update players set country = 'BR' where born like '%Florianapolis%' or born like '%Brasilia%';
update players set country = 'IT' where born like '%Torre Del Greco, Ita%';
update players set country = 'MX' where born like '%Toluca%';
update players set country = 'LU' where born like '%Esch/Alzette%';
update players set country = 'NZ' where born like '%Auckland, New Zealan%';
update players set country = 'MX' where born like '%Mexica%' or born like '%Mexico City%';
update players set country = 'ES' where born like '%Bakio, Bakio%';
update players set country = 'AU' where born like '%Devonport%' or born = 'Devon';
update players set country = 'QA' where born like 'Doha%';
update players set country = 'IT' where born = 'Reggio Calabria';
update players set country = 'HR' where born = 'Zagreb, Yugoslavia';
update players set country = 'SW' where born = 'St.Gallen, Switz.';
update players set country = 'US' where born like '%U.S.A';
update players set country = 'HT' where born = 'Port au Prince';
update players set country = 'IT' where born = 'Rovato (Brescia)'; 
update players set country = 'FI' where born = 'Helsinki';
update players set country = 'US' where born = 'Davenport, IA';
update players set country = 'DE' where born = 'Aschaffenburg';
update players set country = 'GB' where born = 'St Albans';
update players set country = 'IT' where born = 'Erice';
update players set country = 'TW' where born = 'Taichung, Taiwan';
update players set country = 'MX' where born = 'Baja';
update players set country = 'BR' where born = 'Santa Cruz do Sul';
update players set country = 'IR' where born = 'Esfahan';
update players set country = 'US' where born = 'Dallas, TX';
update players set country = 'AT' where born = 'Adelaide';
update players set country = 'GB' where born = 'Colchester';
update players set country = 'RO' where born = 'Bucuresti';
update players set country = 'US' where born = 'Auburn, NY';
update players set country = 'KR' where born = 'Kyunggi-do'; 
update players set country = 'FR' where born = 'BREST';
update players set country = 'UZ' where born = 'Namangan';
update players set country = 'CZ' where born = 'Brno'; 
update players set country = 'SE' where born = 'Lund';
update players set country = 'DE' where born = 'Nurtingen';
update players set country = 'ES' where born = 'Cordoba';
update players set country = 'US' where born = 'Bradenton, FL';
update players set country = 'IT' where born = 'Perugia';
update players set country = 'ES' where born = 'Ciutadella de Menorca';
update players set country = 'ES' where born = 'Jerez de la frontera';
update players set country = 'TR' where born = 'Istanbul';
update players set country = 'IN' where born = 'Pune';
update players set country = 'CZ' where born = 'Moravska Trebova';
update players set country = 'CH' where born = 'Geneva';
update players set country = 'ES' where born = ' Sant Carters de la Rapita,Spain'; 
update players set country = 'GB' where born = 'Belfast';
update players set country = 'IT' where born = 'Como';
update players set country = 'UA' where born = 'Kyiv';
update players set country = 'DE' where born = 'Garmisch-Patenkirchen, GER';
update players set country = 'DE' where born = 'Wasserburg am Inn';
update players set country = 'US' where born = 'San Diego';
update players set country = 'HR' where born = 'Split';
update players set country = 'AR' where born = 'Bragado';
update players set country = 'IN' where born = 'Khanpur Khurd,Jhajjar,Haryana';
update players set country = 'EE' where born = 'Tartu';
update players set country = 'ES' where born = 'Elche';
update players set country = 'JP' where born = 'Nagoya';
update players set country = 'ZA' where born = 'Pretoria';
update players set country = 'DE' where born = 'Berlin';
update players set country = 'TW' where born = 'Changhwa';
update players set country = 'US' where born = 'Pompano Beach, Florida';
update players set country = 'CH' where born = 'Bienne';
update players set country = 'US' where born = 'Calhoun';
update players set country = 'IN' where born = 'Chennai'; 
update players set country = 'IT' where born = 'Florence';
update players set country = 'FR' where born = 'Dunkerque';
update players set country = 'US' where born = 'Sioux City, IA';
update players set country = 'JP' where born = 'Saitma';
update players set country = 'IT' where born = 'Rome';
update players set country = 'NZ' where born = 'Auckland';
update players set country = 'FR' where born = 'Paris';
update players set country = 'US' where born = 'Hilton Head Island';
update players set country = 'DE' where born = 'Cologne';
update players set country = 'SE' where born = 'Hjo';
update players set country = 'US' where born = 'Irvington';
update players set country = 'AU' where born = 'Sydney';
update players set country = 'US' where born = 'Oakland, CA';
update players set country = 'GB' where born = 'Hampstead';
update players set country = 'AU' where born = 'St Kilda East';
update players set country = 'US' where born = 'Honolulu, HI';
update players set country = 'US' where born = 'Torrance, CA';
update players set country = 'CW' where born = 'Willemstad';
update players set country = 'US' where born = 'Murrieta';
update players set country = 'IT' where born = 'San Benedetto del Tronto';
update players set country = 'UA' where born = 'Krivoy Rog';
update players set country = 'PT' where born = 'Lisboa';
update players set country = 'IN' where born = 'Mysore';
update players set country = 'US' where born = 'Omaha';
update players set country = 'ES' where born = 'Barcelona';
update players set country = 'AU' where born = 'Port Pirie';
update players set country = 'SE' where born = 'Gothenburg';
update players set country = 'US' where born = 'Chicago, IL';
update players set country = 'US' where born = 'Stanford, CA';
update players set country = 'IT' where born = 'torino';
update players set country = 'IN' where born = 'Hyderabad';
update players set country = 'DO' where born = 'Santo Domingo';
update players set country = 'FR' where born = 'Clichy';
update players set country = 'RS' where born = 'Novi Sad';
update players set country = 'US' where born = 'Massilon, Ohio';
update players set country = 'FI' where born = 'Turku';
update players set country = 'FR' where born = 'Toulon';
update players set country = 'US' where born = 'Olathe';
update players set country = 'FR' where born = 'La Roche-sur-Yon';
update players set country = 'BR' where born = 'Curitiba, Brasil';
update players set country = 'AM' where born = 'Yerevan';
update players set country = 'US' where born = 'San Antonio';
update players set country = 'IT' where born = 'vicenza';
update players set country = 'US' where born = 'Mobile, AL';
update players set country = 'US' where born = 'Laguna Beach, CA';
update players set country = 'US' where born = 'Austin';
update players set country = 'US' where born = 'Thomasville, GA';
update players set country = 'ES' where born = 'Vic, Barcelona';
update players set country = 'ID' where born = 'Samosir Island';
update players set country = 'UA' where born = 'dnepropetrovsk';
update players set country = 'VE' where born = 'Caracas';
update players set country = 'US' where born = 'Atlanta, GA';
update players set country = 'JP' where born = 'Kanagawa';
update players set country = 'NZ' where born = 'New Plymouth';
update players set country = 'ES' where born = 'San Fernando';
update players set country = 'RU' where born = 'Samara';
update players set country = 'ES' where born = 'Barbastro';
update players set country = 'RU' where born = 'novosibirsk';
update players set country = 'PL' where born = 'Warsaw';
update players set country = 'JP' where born = 'Tokyo';
update players set country = 'DE' where born = 'Duisburg';
update players set country = 'FR' where born = 'Suresnes';
update players set country = 'ES' where born = 'Sant Carles de la Rapita';
update players set country = 'US' where born = 'Milwaukee, WI';
update players set country = 'GB' where born = 'High Wycombe';
update players set country = 'DE' where born = 'Traunstein';
update players set country = 'US' where born = 'San Jose, CA';
update players set country = 'JP' where born = 'Ishikawa';
update players set country = 'DE' where born = 'Rotenburg';
update players set country = 'US' where born = 'Rockville Center, NY';
update players set country = 'US' where born = 'The Dalles, OR';
update players set country = 'FR' where born = 'Levallois';
update players set country = 'LT' where born = 'Vilnius';
update players set country = 'US' where born = 'Tarzana';
update players set country = 'US' where born = 'Accra';
update players set country = 'UA' where born = 'Kiev';
update players set country = 'US' where born = 'Pacific Palisades, CA';
update players set country = 'US' where born = 'Indianapolis';
update players set country = 'US' where born = 'Holtsville';
update players set country = 'US' where born = 'Chico, CA';
update players set country = 'US' where born = 'Wichita, KS';
update players set country = 'DO' where born = 'Santiago';
update players set country = 'US' where born = 'Washington, D.C.';
update players set country = 'DE' where born = 'Hamburg';
update players set country = 'US' where born = 'Trieste';
update players set country = 'FR' where born = 'REIMS';
update players set country = 'ES' where born = 'Valencia';
update players set country = 'US' where born = 'Wilmington, NC';
update players set country = 'ZA' where born = 'Edenvale';
update players set country = 'ZA' where born = 'Bree';
update players set country = 'US' where born = 'Merrick, NY';
update players set country = 'ES' where born = 'San Sebastian';
update players set country = 'US' where born = 'Medina, OH';
update players set country = 'IT' where born = 'Rovereto';
update players set country = 'FR' where born = 'Strasbourg';
update players set country = 'NL' where born = 'Rotterdam';
update players set country = 'PL' where born = 'LODZ';
update players set country = 'US' where born = 'Newport';
update players set country = 'DE' where born = 'Weiden in der Oberpfalz';
update players set country = 'IN' where born = 'Mumbai';
update players set country = 'US' where born = 'Miami';
update players set country = 'IT' where born = 'Formia';
update players set country = 'US' where born = 'Hackensack';
update players set country = 'UZ' where born = 'Tashkent';
update players set country = 'US' where born = 'Melbourne';
update players set country = 'RO' where born = 'Rm Valcea';
update players set country = 'BE' where born = 'Gent';
update players set country = 'CD' where born = 'Kinshasa';
update players set country = 'US' where born = 'Manhasset, NY';
update players set country = 'MG' where born = 'Antananarivo';
update players set country = 'FR' where born = 'Montpellier';
update players set country = 'JP' where born = 'Yamagata';
update players set country = 'US' where born = 'Santa Barbara, CA';
update players set country = 'US' where born = 'Grayling, MI';
update players set country = 'BR' where born = 'Sertaozinho';
update players set country = 'UZ' where born = 'Nukus';
update players set country = 'TN' where born = 'Cartago';
update players set country = 'US' where born = 'Tampa, FL';
update players set country = 'DE' where born = 'Muenster';
update players set country = 'FR' where born = 'Martigues';
update players set country = 'GE' where born = 'Columbus, GA';
update players set country = 'US' where born = 'Fort Lauderdale, FL';
update players set country = 'IT' where born = 'Vercelli';
update players set country = 'CO' where born = 'Bogota';
update players set country = 'RO' where born = 'Ploiesti';
update players set country = 'PF' where born = 'Tahiti';
update players set country = 'HR' where born = 'Split, Yugoslavia';
update players set country = 'JP' where born = 'Hyougo';
update players set country = 'CN' where born = 'Shanghai';
update players set country = 'DE' where born = 'Wiesbaden';
update players set country = 'FR' where born = 'Le Pont-De-Beauvoisin';
update players set country = 'CZ' where born = 'Klatovy';
update players set country = 'US' where born = 'Santa Fe';
update players set country = 'NL' where born = 'Lelystad';
update players set country = 'JP' where born = 'Shizuoka';
update players set country = 'US' where born = 'Metairie, LA';
update players set country = 'TW' where born = 'Hsinchu, Taiwan';
update players set country = 'FR' where born = 'Rennes';
update players set country = 'US' where born = 'Birmingham, AL';
update players set country = 'GB' where born = 'Chichester';
update players set country = 'DO' where born = 'Santo Domingo, Dominican Rep.';
update players set country = 'IT' where born = 'Sanremo';
update players set country = 'US' where born = 'Loma linda'; 
update players set country = 'US' where born = 'Winston Salem';
update players set country = 'FR' where born = 'Rueil-Malmaison';
update players set country = 'US' where born = 'Irvine, CA';
update players set country = 'US' where born = 'Santa Ana';
update players set country = 'BR' where born = 'Recife, Pernambuco';
update players set country = 'MX' where born = 'Saltillo';
update players set country = 'US' where born = 'Glendale, CA';
update players set country = 'CH' where born = 'Lugano';
update players set country = 'US' where born = 'Huntington, NY';
update players set country = 'US' where born = 'Humboldt';
update players set country = 'DE' where born = 'Bergisch - Gladbach';
update players set country = 'US' where born = 'Indianapolis, IN';
update players set country = 'BR' where born = 'Porto Alegre';
update players set country = 'PL' where born = 'Wroclaw';
update players set country = 'CN' where born = 'Wuhan';
update players set country = 'US' where born = 'West Bloomfield, MI';
update players set country = 'IT' where born = 'L Aquila';
update players set country = 'US' where born = 'Walnut Creek, CA';
update players set country = 'DK' where born = 'Frederiksberg';
update players set country = 'RO' where born = 'Pitesti';
update players set country = 'US' where born = 'Cincinnati, OH';
update players set country = 'US' where born = 'Lithonia GA';
update players set country = 'FR' where born = 'Bordeaux';
update players set country = 'BR' where born = 'Belo Horizonte';
update players set country = 'AU' where born = 'Gympie, Queensland, AUS';
update players set country = 'RU' where born = 'Tomsk';
update players set country = 'US' where born = 'South Bend, IN';
update players set country = 'CA' where born = 'Victoria';
update players set country = 'ES' where born = 'Santa Cruz de Bezana';
update players set country = 'IT' where born = 'Bologna';
update players set country = 'DE' where born like '%nchengladbach%';
update players set country = 'BR' where born = 'Jundiai, Sao Paulo, Brasil';
update players set country = 'IT' where born = 'Macerata';
update players set country = 'KZ' where born = 'Aktau';
update players set country = 'IT' where born = 'Campobasso';
update players set country = 'CA' where born like '%St. John%';
update players set country = 'GB' where born = 'Norwich';
update players set country = 'IT' where born = 'Milano';
update players set country = 'AU' where born = 'Launceston, Tasmania, Aust..';
update players set country = 'US' where born = 'Seattle, WA';
update players set country = 'CO' where born = 'Pereira';
update players set country = 'US' where born = 'Washington, DC';
update players set country = 'US' where born = 'Hialeah, FL';
update players set country = 'US' where born = 'Hershey';
update players set country = 'BE' where born = 'Verviers';
update players set country = 'AU' where born = 'Traralgon';
update players set country = 'US' where born = 'Titusville, Florida';
update players set country = 'IT' where born = 'Civitavecchia';
update players set country = 'GB' where born = 'Leeds';
update players set country = 'BI' where born = 'Gitega';
update players set country = 'PL' where born = 'Zielona Gora';
update players set country = 'FR' where born = 'carhaix plougher';
update players set country = 'US' where born = 'Baltimore, Maryland';
update players set country = 'US' where born = 'Avon, CT';
update players set country = 'US' where born = 'Highland Park, Illinois';
update players set country = 'NL' where born = 'Groningen';
update players set country = 'DO' where born = 'Santiago De Los Caballeros';
update players set country = 'BR' where born = 'Pilar';
update players set country = 'US' where born = 'Skokie, Illinois';
update players set country = 'US' where born = 'Columbia, SC';
update players set country = 'IT' where born = 'Monterotondo';
update players set country = 'AU' where born = 'Perth';
update players set country = 'ES' where born = 'Burgos';
update players set country = 'GB' where born = 'Birmingham';
update players set country = 'UA' where born = 'Chernivtsi';
update players set country = 'CH' where born = 'Flawil';
update players set country = 'US' where born = 'Newark, NJ';
update players set country = 'US' where born = 'Colorado Springs';
update players set country = 'IT' where born = 'Monselice';
update players set country = 'US' where born = 'Buffalo, NY';
update players set country = 'KR' where born = 'Anseong';
update players set country = 'CN' where born = 'HEILONGJIANG';
update players set country = 'FR' where born = 'Biarritz';
update players set country = 'ES' where born = 'Adeje';
update players set country = 'FR' where born = 'Ajaccio';
update players set country = 'FR' where born = 'Gonesse';
update players set country = 'KR' where born = 'Daejeon';
update players set country = 'MX' where born = 'Acapulco';
update players set country = 'US' where born = 'Chandler Arizona';
update players set country = 'US' where born = 'Arlington';
update players set country = 'CZ' where born = 'Kolin';
update players set country = 'US' where born = 'Minneapolis, MN';
update players set country = 'US' where born = 'Mountainview, CA';
update players set country = 'EC' where born = 'Quito';
update players set country = 'KH' where born = 'Battambang, Camboda';
update players set country = 'IL' where born = 'Petach Tikva';
update players set country = 'GB' where born = 'Norwich, Norfolk';
update players set country = 'US' where born = 'Hattiesburg, MS';
update players set country = 'US' where born = 'Walnut Creek';
update players set country = 'RU' where born = 'Vladikavkaz, North-Ossetia';
update players set country = 'US' where born = 'Boston';
update players set country = 'PL' where born = 'Walbrzych';
update players set country = 'FR' where born = 'Saint-julien-en-genevois';
update players set country = 'NL' where born = 'Dirksland';
update players set country = 'GB' where born = 'KINGSTON UPON THAMES';
update players set country = 'DZ' where born = 'oran';
update players set country = 'AT' where born = 'Schwaz';
update players set country = 'US' where born = 'Hoboken, NJ';
update players set country = 'IT' where born = 'Ancona';
update players set country = 'JP' where born = 'Okayama';
update players set country = 'US' where born = 'Annandale, VA';
update players set country = 'FR' where born = 'Schoelcher';
update players set country = 'RU' where born = 'Ufa';
update players set country = 'TW' where born = 'keelung';
update players set country = 'FR' where born = 'Grenoble';
update players set country = 'GB' where born = 'Chelmsford';
update players set country = 'GB' where born = 'Hatfield';
update players set country = 'IT' where born = 'Messina';
update players set country = 'JP' where born = 'nishinomiya';
update players set country = 'US' where born = 'Princeton';
update players set country = 'US' where born = 'Tulsa';
update players set country = 'US' where born = 'Princeton NJ';
update players set country = 'CL' where born = 'Punta Arenas';
update players set country = 'ZA' where born = 'Gauteng';
update players set country = 'US' where born = 'Redwood City, CA';
update players set country = 'ES' where born = 'Algemesi';
update players set country = 'RU' where born = 'Taganrog';
update players set country = 'CA' where born = 'Montreal';
update players set country = 'RU' where born = 'Rostov-on-Don';
update players set country = 'MG' where born = 'Toamasina';
update players set country = 'IT' where born = 'Turin';
update players set country = 'CH' where born = 'Rheinfelden';
update players set country = 'DE' where born = 'Nuremberg';
update players set country = 'LT' where born like '%Siauliai%';
update players set country = 'DE' where born like '%Duesseldorf%'; 
update players set country = 'FR' where born = 'Sucy En Brie';
update players set country = 'DE' where born = 'Reutlingen';
update players set country = 'US' where born = 'Mineola';
update players set country = 'US' where born = 'Asheville, NC';
update players set country = 'BE' where born = 'Vilvoorde';
update players set country = 'US' where born = 'Newport News, VA';
update players set country = 'SE' where born = 'Stockholm';
update players set country = 'IT' where born = 'Alatri';
update players set country = 'US' where born = 'San Francisco, CA';
update players set country = 'UY' where born like '%Paysand?%';  
update players set country = 'AU' where born = 'Campbelltown';
update players set country = 'AU' where born = 'Port Lincoln';
update players set country = 'CA' where born = 'Oakville';
update players set country = 'NA' where born = 'Windhoek';
update players set country = 'AR' where born = 'Rauch';
update players set country = 'BA' where born = 'Sarajevo';
update players set country = 'US' where born = 'Miami, FL';
update players set country = 'AT' where born = 'Linz';
update players set country = 'US' where born = 'Galveston';
update players set country = 'IT' where born = 'Genova';
update players set country = 'NL' where born = 'Haarlem';
update players set country = 'PT' where born = 'Funchal';
update players set country = 'US' where born = 'Hartland, WI';
update players set country = 'IT' where born = 'Verona';
update players set country = 'US' where born = 'Fort Dix, NJ';
update players set country = 'RU' where born = 'Simferopol, Crimea';
update players set country = 'GB' where born = 'Southend-on-sea, Essex';
update players set country = 'IL' where born = 'Haifa';
update players set country = 'US' where born = 'Flushing, NY';
update players set country = 'FR' where born = 'Noumea';
update players set country = 'US' where born = 'Altadena';
update players set country = 'US' where born = 'Atlanta';
update players set country = 'BG' where born = 'Asenovgrad';
update players set country = 'BE' where born = 'Itzehoe';
update players set country = 'RO' where born = 'Cugir';
update players set country = 'CH' where born = 'Wil';
update players set country = 'IT' where born = 'Roma';
update players set country = 'CA' where born = 'Newmarket';
update players set country = 'CH' where born = 'Bern';
update players set country = 'US' where born = 'Knoxville, Tennessee';
update players set country = 'US' where born = 'Memphis, TN';
update players set country = 'ZA' where born = 'Johanesburg';
update players set country = 'US' where born = 'Springfield, MA';
update players set country = 'RU' where born = 'Penza';
update players set country = 'US' where born = 'Concord';
update players set country = 'FR' where born = 'Lons le saunier';
update players set country = 'RO' where born = 'Constanta';
update players set country = 'PR' where born = 'San Juan';
update players set country = 'DE' where born = 'Bonn';
update players set country = 'US' where born = 'Knoxville, Tennessee'; 
update players set country = 'PT' where born = 'Santa Cruz';
update players set country = 'GB' where born = 'Exeter';
update players set country = 'EE' where born = 'Tallinn';
update players set country = 'GB' where born = 'Taunton';
update players set country = 'US' where born = 'Boise, Idaho';
update players set country = 'IT' where born = 'Pisa';
update players set country = 'DE' where born like '%Gr?felfing%';  
update players set country = 'CA' where born = 'Longueuil';
update players set country = 'RU' where born = 'Orenbourg';
update players set country = 'ES' where born = 'Leon';
update players set country = 'AR' where born = 'La Plata';
update players set country = 'CR' where born = 'San Jose';
update players set country = 'AR' where born = 'Marco Juarez';
update players set country = 'US' where born = 'Naperville, IL';
update players set country = 'AE' where born = 'Dubai';
update players set country = 'DE' where born = 'Achim';
update players set country = 'US' where born = 'Sacramento, CA';
update players set country = 'PL' where born = 'Ostrow Wlkp';
update players set country = 'MK' where born = 'Skopje, Macedonia';
update players set country = 'JP' where born = 'fukuoka';
update players set country = 'JP' where born = 'Yokohama';
update players set country = 'DE' where born = 'Paderborn';
update players set country = 'BR' where born = 'Brasilia';
update players set country = 'US' where born = 'Pasadena, CA';
update players set country = 'ES' where born = 'Gijon';
update players set country = 'KZ' where born like '%hymkent%';
update players set country = 'US' where born = 'Belfonte, PA';
update players set country = 'IT' where born = 'Subiaco';
update players set country = 'DE' where born = 'Bad Hersfeld';
update players set country = 'RU' where born = 'Kazan';
update players set country = 'PT' where born = 'Guimaraes';
update players set country = 'AT' where born = 'Portschach am Worthersee';
update players set country = 'FR' where born = 'BASTIA';
update players set country = 'FR' where born = 'Pouillon';
update players set country = 'US' where born = 'Bogalusa, LA';
update players set country = 'UA' where born = 'Kharkiv';
update players set country = 'US' where born = 'Fresno, California';
update players set country = 'US' where born = 'Boulder, CO';
update players set country = 'US' where born = 'Davis';
update players set country = 'US' where born = 'Jacksonville, FL';
update players set country = 'US' where born = 'Shelby, NC';
update players set country = 'US' where born = 'Richmond, VA';
update players set country = 'CN' where born = 'Hunan';
update players set country = 'US' where born = 'Columbus, OH';
update players set country = 'IE' where born = 'dublin';
update players set country = 'AT' where born = 'Hall in Tirol';
update players set country = 'GE' where born = 'Atlanta Ga';
update players set country = 'MX' where born = 'Queretaro';
update players set country = 'FR' where born = 'Carcassonne';
update players set country = 'CN' where born = 'Dalian';
update players set country = 'FR' where born = 'Saint Jean de Maurienne';
update players set country = 'PT' where born = 'Peniche';
update players set country = 'JP' where born = 'Senboku District, Osaka';
update players set country = 'IT' where born = 'Pescara';
update players set country = 'AU' where born = 'Leongatha, Victoria';
update players set country = 'US' where born = 'Ludington, MI';
update players set country = 'ES' where born = 'Pamplona';
update players set country = 'PT' where born = 'Porto';
update players set country = 'GB' where born = 'Sunderland';
update players set country = 'SE' where born = 'Kristianstad';
update players set country = 'IT' where born = 'Licata';
update players set country = 'PL' where born = 'Warszawa';
update players set country = 'US' where born = 'Hinsdale, Illinois';
update players set country = 'GB' where born = 'Newcastle upon Tyne';
update players set country = 'US' where born = 'Bartow, FL';
update players set country = 'MX' where born = 'Apizaco';
update players set country = 'FR' where born = 'Lyon';
update players set country = 'KR' where born = 'Seoul';
update players set country = 'BR' where born = 'Campinas';
update players set country = 'CZ' where born like '%Hodon?n%'; 
update players set country = 'MD' where born = 'Chisinau';
update players set country = 'JP' where born = 'Fukushima'; 
update players set country = 'AT' where born = 'Wr.Neustadt';
update players set country = 'US' where born = 'Harvey, IL';
update players set country = 'US' where born = 'Des Moines';
update players set country = 'US' where born = 'St. Louis, MO';
update players set country = 'HR' where born = 'Zagreb';
update players set country = 'FR' where born = 'Aix-en-Provence';
update players set country = 'UA' where born = 'Donetsk';
update players set country = 'FR' where born = 'Nogent sur marne';
update players set country = 'BE' where born = 'Woluwe St Lambert';
update players set country = 'US' where born = 'Scarsdale, NY';
update players set country = 'CN' where born = 'Taiwan';
update players set country = 'CA' where born = 'Calgary';
update players set country = 'BR' where born = 'Capital Federal';
update players set country = 'US' where born = 'Berkeley, CA';
update players set country = 'IT' where born = 'Guastalla';
update players set country = 'BR' where born like '%S?o Paulo%'; 
update players set country = 'IT' where born = 'Rimini';
update players set country = 'TR' where born = 'Izmir';
update players set country = 'CL' where born = 'Providencia';
update players set country = 'AR' where born = 'Balcarce';
update players set country = 'ZA' where born = 'Port Elizabeth';
update players set country = 'UA' where born = 'Evpatoria';
update players set country = 'IT' where born = 'Urbino';
update players set country = 'CZ' where born = 'Ostrava';
update players set country = 'US' where born = 'West Palm Beach';
update players set country = 'US' where born = 'Toledo, OH';
update players set country = 'BG' where born = 'Dimitrovgrad';
update players set country = 'ES' where born = 'Las Palmas';
update players set country = 'US' where born = 'Huntington Park, California';
update players set country = 'US' where born = 'Pittsburgh, PA';
update players set country = 'BO' where born = 'La Paz';
update players set country = 'AR' where born = 'Villa Maria Cordoba';
update players set country = 'US' where born = 'Newport Beach, CA';
update players set country = 'RO' where born = 'Iasi';
update players set country = 'JP' where born = 'Hyogo';
update players set country = 'AR' where born = 'Ciudad Aut?noma de Buenos';  
update players set country = 'FR' where born = 'Frejus';
update players set country = 'FR' where born = 'Neuilly-sur-Seine';
update players set country = 'BB' where born = 'Bridgetown';
update players set country = 'US' where born = 'Cincinnati, OH, U.S.A';
update players set country = 'PE' where born = 'Lima';
update players set country = 'FR' where born = 'Villeurbanne';
update players set country = 'NL' where born = 'Permerand, Holland';
update players set country = 'CN' where born = 'Tianjin';
update players set country = 'US' where born = 'Ann Arbor, MI';
update players set country = 'US' where born = 'Detroit, Michigan';
update players set country = 'RO' where born = 'Bacau'; 
update players set country = 'GB' where born = 'Olney';
update players set country = 'SE' where born = 'Karlskrona';
update players set country = 'IT' where born = 'Pesaro';
update players set country = 'GB' where born = 'Redditch';
update players set country = 'DE' where born = 'Starnberg';
update players set country = 'KZ' where born = 'Temirtau';
update players set country = 'KR' where born = 'AN SUNG'; 
update players set country = 'BE' where born = 'leuven';
update players set country = 'AT' where born = 'Vienna';
update players set country = 'KR' where born = 'Suwon';
update players set country = 'VE' where born = 'Barquisimeto';
update players set country = 'BE' where born = 'Namur';
update players set country = 'NL' where born = 'Waalwijk';
update players set country = 'SI' where born = 'Trbovlje';
update players set country = 'GB' where born = 'Box Hill';
update players set country = 'BG' where born = 'Sofia';
update players set country = 'FR' where born = 'Bayonne';
update players set country = 'AR' where born = 'Corrientes';
update players set country = 'AU' where born = 'Gold Coast';
update players set country = 'CZ' where born = 'Valasske Mezirici';
update players set country = 'NZ' where born = 'Wellington';
update players set country = 'HR' where born = 'Zagreb, Yugoslavia';
update players set country = 'BE' where born = 'Diest';
update players set country = 'BE' where born = 'Forchheim';
update players set country = 'JP' where born = 'Osaka';
update players set country = 'GB' where born = 'Nottingham';
update players set country = 'PT' where born = 'Lisbon';
update players set country = 'US' where born = 'Fargo';
update players set country = 'BG' where born = 'VARNA';  
update players set country = 'ZA' where born like '%King William%'; 
update players set country = 'US' where born = 'Santa Clara, CA';
update players set country = 'EC' where born = 'Guayaquil';
update players set country = 'IN' where born = 'Visakhapatnam';
update players set country = 'CZ' where born = 'Pilsen';
update players set country = 'DE' where born = 'Friedrichshafen';
update players set country = 'PH' where born = 'Cagayan de Oro City';
update players set country = 'SI' where born = 'maribor';
update players set country = 'AR' where born = 'Merlo';
update players set country = 'IN' where born = 'Delhi';
update players set country = 'CN' where born = 'Tainan';
update players set country = 'FR' where born = 'Longjumeau';
update players set country = 'FR' where born = 'Saint-Nazaire';
update players set country = 'IT' where born = 'Busto Arsizio';
update players set country = 'BE' where born = 'Essen';
update players set country = 'ZA' where born = 'Durban';
update players set country = 'US' where born = 'Fort Ord, CA';
update players set country = 'DO' where born = 'Puerto Plata';
update players set country = 'FR' where born = 'Marseille';
update players set country = 'US' where born = 'Hollywood, CA';
update players set country = 'CH' where born = 'Chur';
update players set country = 'US' where born = 'Irvine';
update players set country = 'RS' where born = 'Vrbas, Yugoslavia';
update players set country = 'US' where born = 'Santa Monica';
update players set country = 'FR' where born = 'Villeneuve saint Georges';
update players set country = 'CZ' where born = 'Jindrichuv Hradec, Cz Republic';
update players set country = 'US' where born = 'Salem';
update players set country = 'US' where born = 'Westlake Village, California';
update players set country = 'NL' where born = 'Heythuysen';
update players set country = 'AR' where born = 'Villa Gesell';
update players set country = 'AT' where born = 'Graz';
update players set country = 'AR' where born = 'Bahia Blanca';
update players set country = 'JP' where born = 'Toyama';
update players set country = 'EG' where born = 'Alexandria';
update players set country = 'SK' where born = 'Bratislava';
update players set country = 'BR' where born = 'Sao paulo';
update players set country = 'CZ' where born = 'Ostrov';
update players set country = 'KR' where born = 'Jeju';
update players set country = 'GB' where born = 'Stevenage';
update players set country = 'IT' where born = 'Novara';
update players set country = 'IN' where born = 'Bengaluru';
update players set country = 'US' where born = 'Charleston, WV';
update players set country = 'RU' where born = 'Saint-Petersburg';
update players set country = 'US' where born = 'Greenbrae';
update players set country = 'CZ' where born = 'Prague';
update players set country = 'US' where born = 'Palo Alto';
update players set country = 'CH' where born = 'Frauenfeld';
update players set country = 'ES' where born = 'Madrid';
update players set country = 'PL' where born = 'Priemysl';
update players set country = 'AT' where born = 'Klagenfurt';
update players set country = 'US' where born = 'Kalamazoo';
update players set country = 'US' where born = 'Fresno';
update players set country = 'US' where born = 'Spokane';
update players set country = 'NL' where born = 'Alphen aan den Rijn';
update players set country = 'PT' where born = 'Montijo';
update players set country = 'NL' where born = 'Utrecht';
update players set country = 'US' where born = 'Does Moines';
update players set country = 'DE' where born = 'Munich';
update players set country = 'US' where born = 'Highpoint, NC';
update players set country = 'PT' where born = 'Oliveira de Azem?is';  
update players set country = 'RO' where born = 'Klausenburg, Rumania';
update players set country = 'AU' where born = 'Brisbane';
update players set country = 'JP' where born = 'Itabashi, Tokyo';
update players set country = 'MX' where born = 'Tampico';
update players set country = 'DE' where born = 'schwaebisch hall';
update players set country = 'CN' where born = 'sichuan suining';
update players set country = 'IT' where born = 'Ravenna';
update players set country = 'US' where born = 'Arlington, TX';
update players set country = 'BR' where born = 'Curitiba';
update players set country = 'CN' where born = 'Xin jiang';
update players set country = 'AR' where born = 'Mendoza';
update players set country = 'DE' where born = 'Bremen';
update players set country = 'NL' where born = 'Blaricum';
update players set country = 'CN' where born = 'Jiangsu';
update players set country = 'US' where born = 'Boca Raton';
update players set country = 'AU' where born = 'Symmons, Plains,Tasmania,Aust.';
update players set country = 'CL' where born = 'Iquique';
update players set country = 'TR' where born = 'Tekirdag';
update players set country = 'FR' where born = 'Saint Etienne';
update players set country = 'IT' where born = 'Casalmaggiore';
update players set country = 'HU' where born = 'Budapest';
update players set country = 'CA' where born = 'Vancouver';
update players set country = 'BG' where born = 'Sliven';
update players set country = 'GB' where born = 'Penrith';
update players set country = 'US' where born = 'Stamford';
update players set country = 'AR' where born = 'Mar del Palta';
update players set country = 'NL' where born = 'Hoorn';
update players set country = 'US' where born = 'Boonton, NJ';
update players set country = 'PL' where born = 'Tomaszow Mazowiecki';
update players set country = 'KZ' where born = 'Almaty';
update players set country = 'BE' where born = 'Roeselare';
update players set country = 'FR' where born = 'NIMES';
update players set country = 'US' where born = 'Sacramento';
update players set country = 'FR' where born = 'Boulogne-Sur-Mer';
update players set country = 'SK' where born = 'Trnava';
update players set country = 'US' where born = 'Glen Cove, NY';
update players set country = 'US' where born = 'Brevard, North Carolina';
update players set country = 'US' where born = 'Memphis, Tennessee';
update players set country = 'US' where born = 'Bradenton';
update players set country = 'IT' where born = 'Cuneo'; 
update players set country = 'BR' where born = 'Sinop, Mato Grosso';
update players set country = 'US' where born = 'Los Angeles, CA';
update players set country = 'BR' where born = 'Uruguaiana';
update players set country = 'US' where born like '%New York%';
update players inner join paises on paises.codigo like '%BR%' set players.country = paises.codigo where players.country is null and born like '%Bernardo do Campo%' ;
update players inner join paises on paises.codigo like '%BR%' set players.country = paises.codigo where players.country is null and born like '%Londrina- Paran%' ;
update players inner join paises on paises.codigo like '%BR%' set players.country = paises.codigo where players.country is null and born like '%o Paulo%' ;
update players inner join paises on paises.codigo like '%PT%' set players.country = paises.codigo where players.country is null and born like '%Oliveira de Azem%' ;
update players inner join paises on paises.codigo like '%ES%' set players.country = paises.codigo where players.country is null and born like '%Sant Carters de la Rapita%' ;
update players inner join paises on paises.codigo like '%SE%' set players.country = paises.codigo where players.country is null and born like 'Eksj%' ;
update players inner join paises on paises.codigo like '%KR%' set players.country = paises.codigo where players.country is null and born like 'Andong%' ;
update players inner join paises on paises.codigo like '%CZ%' set players.country = paises.codigo where players.country is null and born like 'Hradec Kr%' ;
update players inner join paises on paises.codigo like '%DE%' set players.country = paises.codigo where players.country is null and born like '%bingen' ;
update players inner join paises on paises.codigo like '%KR%' set players.country = paises.codigo where players.country is null and born like 'Gangwon%' ;
update players inner join paises on paises.codigo like '%DE%' set players.country = paises.codigo where players.country is null and born like '%stringen' ;
update players inner join paises on paises.codigo like '%FR%' set players.country = paises.codigo where players.country is null and born like 'Noum%' ;
update players inner join paises on paises.codigo like '%TW%' set players.country = paises.codigo where players.country is null and born = 'Chunghua' ;
update players inner join paises on paises.codigo like '%AR%' set players.country = paises.codigo where players.country is null and born like '%o Cuarto, C%' ;
update players inner join paises on paises.codigo like '%IT%' set players.country = paises.codigo where players.country is null and born like 'Ciri%' ;
update players inner join paises on paises.codigo like '%FI%' set players.country = paises.codigo where players.country is null and born like 'Hyvink%' ;
update players inner join paises on paises.codigo like '%AU%' set players.country = paises.codigo where players.country is null and born = 'Monto' ;
update players inner join paises on paises.codigo like '%BY%' set players.country = paises.codigo where players.country is null and born = 'Barakovichi' ;
update players inner join paises on paises.codigo like '%ZA%' set players.country = paises.codigo where players.country is null and born like 'King William%' ;
update players inner join paises on paises.codigo like '%CO%' set players.country = paises.codigo where players.country is null and born like 'Chascom%' ;
update players inner join paises on paises.codigo like '%AR%' set players.country = paises.codigo where players.country is null and born like 'Ciudad Aut%' ;
update players inner join paises on paises.codigo like '%DE%' set players.country = paises.codigo where players.country is null and born like '%beck' ;
update players inner join paises on paises.codigo like '%CZ%' set players.country = paises.codigo where players.country is null and born like 'Hodon%' ;
update players inner join paises on paises.codigo like '%BE%' set players.country = paises.codigo where players.country is null and born like 'Li%' ;
update players inner join paises on paises.codigo like '%FR%' set players.country = paises.codigo where players.country is null and born like '%vres%' ;
update players inner join paises on paises.codigo like '%MP%' set players.country = paises.codigo where players.country is null and born = 'Saipan' ;
update players inner join paises on paises.codigo like '%DE%' set players.country = paises.codigo where players.country is null and born like '%felfing' ;
update players inner join paises on paises.codigo like '%UY%' set players.country = paises.codigo where players.country is null and born like 'Paysand%' ;
update players inner join paises on paises.codigo like '%TT%' set players.country = paises.codigo where players.country is null and born like 'Trinidad%' ;
update players inner join paises on paises.codigo like '%FR%' set players.country = paises.codigo where players.country is null and born like '%ret' ;
update players inner join paises on paises.codigo like concat(players.country,'%') set players.country = paises.codigo;

delete from games where winner_id is null and loser_id is null;

alter table games add constraint id_torneio foreign key (tournament_id) references tournaments(id);
alter table games add constraint id_player_loser foreign key (loser_id) references players(id);
alter table games add constraint id_player_winner foreign key (winner_id) references players(id);
alter table tournaments add constraint country_tournament foreign key (country) references paises(codigo);
alter table players add constraint country_players_born foreign key (country) references paises(codigo);
ALTER TABLE `paises` ADD PRIMARY KEY (`Codigo`);
ALTER TABLE `games` ADD PRIMARY KEY (`GameRound`, `tournament_id`, `winner_id`, `loser_id`);
ALTER TABLE `atp`.`players` DROP INDEX `id`, ADD UNIQUE `id_index` (`id`) USING BTREE;
ALTER TABLE `players` ADD PRIMARY KEY (`id`);
ALTER TABLE `atp`.`tournaments` DROP INDEX `id`, ADD UNIQUE `id_indexx` (`id`) USING BTREE;
ALTER TABLE `tournaments` ADD PRIMARY KEY(`id`);





alter table games drop column date;
alter table games drop column opponent;
alter table games drop column Player;
alter table games drop column tournament;
alter table games drop column WL;
alter table games drop column player1_id;
alter table games drop column player2_id;
drop view missing_players;











ALTER TABLE `games` ADD INDEX(`tournament_id`);
ALTER TABLE `tournaments` ADD INDEX(`country`);
ALTER TABLE `paises` ADD INDEX(`Codigo`);



create view ex_1_1 as select paises.pais pais, count(players.name) n_players from paises left join players on paises.codigo = players.country group by paises.pais;
create view ex_1_2 as select paises.pais pais, count(tournaments.name) n_tournaments from paises left join tournaments on paises.codigo = tournaments.country group by paises.pais;
create view ex_1_3 as select paises.pais pais, count(games.tournament_id) n_jogos  from paises left join tournaments on paises.codigo = tournaments.country left join games on tournaments.id = games.tournament_id group by paises.pais;


create view ex_1 as select ex_1_1.pais Pais, ex_1_1.n_players Numero_Jogadores,ex_1_2.n_tournaments Numero_Torneios,ex_1_3.n_jogos Numero_Jogos from ex_1_1, ex_1_2, ex_1_3 where ex_1_1.pais = ex_1_2.pais and ex_1_2.pais = ex_1_3.pais; 











create view games_won as select players.id ide,players.name Player, count(games.winner_id) won_num from players,games where players.id = games.winner_id group by games.winner_id;
create view games_lost as select players.id ide,players.name Player, count(games.loser_id) lost_num from players,games where players.id = games.loser_id group by games.loser_id;
create view ex_2 as select games_won.Player, ((games_won.won_num/(games_won.won_num+games_lost.lost_num))*100) Perc from games_won, games_lost where(games_won.ide = games_lost.ide) order by perc desc limit 10;



create view ex3_1 as select players.id ide, players.name Player, count(games.winner_id) won_n from players,games,tournaments 
where players.id = games.winner_id and games.tournament_id = tournaments.id and players.mainhand = 'Left-Handed' and tournaments.name = 'Roland Garros' 
or tournaments.name = 'US Open' and players.id = games.winner_id and games.tournament_id = tournaments.id and players.mainhand = 'Left-Handed' 
or tournaments.name = 'Wimbledon' and players.id = games.winner_id and games.tournament_id = tournaments.id and players.mainhand = 'Left-Handed' 
or tournaments.name = 'Australian Open' and players.id = games.winner_id and games.tournament_id = tournaments.id and players.mainhand = 'Left-Handed' group by games.winner_id;

create view ex3_2 as select players.id ide, players.name Player, count(games.loser_id) lost_n from players,games,tournaments 
where players.id = games.loser_id and games.tournament_id = tournaments.id and players.mainhand = 'Left-Handed' and tournaments.name = 'Roland Garros' 
or tournaments.name = 'US Open' and players.id = games.loser_id and games.tournament_id = tournaments.id and players.mainhand = 'Left-Handed' 
or tournaments.name = 'Wimbledon' and players.id = games.loser_id and games.tournament_id = tournaments.id and players.mainhand = 'Left-Handed' 
or tournaments.name = 'Australian Open' and players.id = games.loser_id and games.tournament_id = tournaments.id and players.mainhand = 'Left-Handed' group by games.loser_id;

create view ex_3 as select ex3_2.Player, ((ex3_1.won_n/(ex3_1.won_n+ex3_2.lost_n))*100) perc from ex3_2,ex3_1 where ex3_2.ide = ex3_1.ide order by perc desc limit 10; 







create view ex_4 as select players.name Nome ,count(games.winner_id) Vitorias from players,games,tournaments where players.id = games.winner_id and games.tournament_id = tournaments.id and tournaments.ground = 'Hard' group by Nome order by vitorias desc limit 5;




select * from ex_1;
select * from ex_2;
select * from ex_3;
select * from ex_4;
